CREATE VIEW V_GCG_6311_PO_RECPTS AS Select B.RECEIVER_NO, A.VENDOR, A.PURCHASE_ORDER, A.RECORD_NO as PO_LINE, A.PART, A.DESCRIPTION as PART_DESCRIPTION, A.QTY_ORDER as PO_LINE_ORDER_QTY, IF(B.QTY_RECEIVED is null,0.00,B.QTY_RECEIVED) as QTY_RECEIVED, IF(B.QTY_RECEIVED is null,0.00,IF(A.UM_PURCHASING <> A.UM_INVENTORY,D.FACTOR_CONVERSION * B.QTY_RECEIVED,B.QTY_RECEIVED)) as INV_QTY_RECEIVED, IF(QTY_INVOICED IS NULL,0.00,QTY_INVOICED) AS QTY_INVOICED, IF(A.QTY_ORDER - A.QTY_RECEIVED < 0,0.00,A.QTY_ORDER - A.QTY_RECEIVED) as OPEN_QTY, A.COST as UNIT_PRICE, B.DATE_RECEIVED, IF(A.FLAG_RECV_CLOSE = 'Y','3','1') as STATUS, IF(B.GL_ACCOUNT IS NULL,A.GL_ACCOUNT_LINE,B.GL_ACCOUNT) as EXPENSE_ACCOUNT, C.NORMAL_GL_ACCOUNT as PAYABLE_ACCOUNT, IF(B.TAXABLE IS NULL,CAST(0 AS BIT),B.TAXABLE) AS TAXABLE, A.DATE_DUE_LINE From V_PO_LINES A LEFT Join V_PO_RECEIVER B on a.Purchase_Order = b.Purchase_Order and B.PO_Line4 = A.Record_no Left Join V_Vendor_Master C on A.Vendor = C.Vendor Left Join V_Inventory_Mstr D on Replace(B.Part,'*','') = D.Part and B.Location = D.Location;